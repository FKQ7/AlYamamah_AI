{% extends "base.html" %}
{% load static %}

{% block content %}
<section dir="rtl" class="container mx-auto py-12 px-4 min-h-screen">
  
  <div class="mb-12 relative">
    <!-- Header Image -->
    <div class="w-full h-64 md:h-96 rounded-2xl overflow-hidden mb-6 shadow-lg bg-gray-200">
      {% if club.header %}
        <img
          class="object-cover w-full h-full"
          src="{{ club.header.url }}"
          alt="صورة رأس نادي {{ club.name }}"
        />
      {% else %}
        <!-- Placeholder if no header image -->
        <div class="w-full h-full bg-gradient-to-r from-orange-500 to-orange-400 flex items-center justify-center">
          <span class="text-white text-5xl font-bold opacity-50">{{ club.name }}</span>
        </div>
      {% endif %}
    </div>

    <!-- Club Logo (Square) -->
    <div class="absolute -bottom-12 right-1/2 transform translate-x-1/2 md:right-16 md:translate-x-0 md:-bottom-16 w-32 h-32 md:w-48 md:h-48 border-4 border-white rounded-xl overflow-hidden shadow-2xl bg-white">
      {% if club.img %}
        <img
          class="object-cover w-full h-full"
          src="{{ club.img.url }}"
          alt="شعار نادي {{ club.name }}"
        />
      {% else %}
        <div class="w-full h-full bg-orange-100 flex items-center justify-center">
          <!-- Show first letter of club name as placeholder -->
          <span class="text-orange-500 text-6xl font-bold">{{ club.name.0 }}</span>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- Club Name & Description (shifted down) -->
  <div class="pt-20 md:pt-16 text-center md:text-right md:pr-72">
    <h1 class="text-3xl md:text-5xl font-bold text-gray-800 mb-4">
      {{ club.name }}
    </h1>
    <!-- Set max-width to prevent text from flowing under the logo weirdly -->
    <div class="prose prose-lg max-w-none md:max-w-4xl text-gray-700 leading-relaxed">
      {{ club.description|safe }}
    </div>
  </div>

  <div class="container mx-auto mt-16 border-t-4 border-orange-400 pt-12">
    <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-8 text-center md:text-right">
      كتّاب النادي 
    </h2>
    <div dir="ltr" class="flex flex-wrap justify-center md:justify-end gap-6">
      
      {% for member in club.members.all %}
        <a href="{% url 'writer_profile' member.id %}" class="flex flex-col items-center p-4 bg-white rounded-lg shadow-lg w-40 transition-transform duration-300 hover:scale-105">
          <img class="w-24 h-24 rounded-full mb-3 object-cover border-2 border-orange-200" 
               src="https://placehold.co/100x100/f97316/FFFFFF/png?text={{ member.first_name.0|default:'' }}{{ member.last_name.0|default:'' }}" 
               alt="صورة {{ member.first_name }} {{ member.last_name }}">
          <p class="text-lg font-semibold text-gray-800 text-center">{{ member.first_name }} {{ member.last_name }}</p>
          <p class="text-sm text-gray-500 text-center">@{{ member.username }}</p>
        </a>
      {% empty %}
        <p class="text-gray-500 text-center col-span-full py-8 text-lg">لا يوجد أعضاء في هذا النادي حالياً.</p>
      {% endfor %}

    </div>
  </div>


  <div class="News-blogs container mx-auto mt-16 border-t-4 border-orange-400 pt-8">
    <div class_ ="py-8 lg:mx-auto lg:max-w-screen-2xl text-center lg:py-12 lg:px-12">
      <h1 class="text-center mt-10 mb-4 md:mt-10 text-5xl font-bold">
        آخر أخبار ومقالات النادي
      </h1>
      
      <div class="hidden texttt xl:block" dir="rtl">
        <div class="flex justify-between w-full mx-auto pb-3">
          <p class="pr- text-4xl font-bold">اخبار النادي</p>
          <p class="pr-12 text-4xl font-bold">مقالات النادي</p>
          <p></p>
        </div>
      </div>

      
      <div class="flex flex-col px-2 xl:flex-row md:container md:mx-auto md:px-16 xl:px-0" dir="rtl">
            
        <!-- News Column -->
        <div class="w-full xl:w-1/2 xl:px-1">
          <div class="xl:hidden text-right px-5 pb-2 text-4xl font-bold " dir="rtl">
            <p>اخبار النادي</p>
          </div>
          
          <!-- Loop through related_news -->
          {% for news_item in related_news %}
          <div class="block w-full"> 
            <div class="w-full lg:h-[230px] rounded-md " dir="rtl">
              <div class="flex w-full h-full p-3 border-[2px] hover:bg-[#eeede8] border-primary-400 text-text rounded-lg xl:rounded-xl mt-2 shadow-md" >
                
                {% if news_item.img %}
                <a href="{% url 'details_news' news_item.id %}" class="block flex-shrink-0">
                  <img class="w-[80px] h-[80px] sm:w-[100px] sm:h-[100px] md:w-[152px] md:h-[152px] lg:w-[170px] lg:h-[170px] rounded-xl object-cover mb-3 md:mb-0 md:mr-4" 
                       src="{{ news_item.img.url }}" alt="صورة خبر {{ news_item.title }}">
                </a>
                {% else %}
                <a href="{% url 'details_news' news_item.id %}" class="block flex-shrink-0">
                  <img class="w-[80px] h-[80px] sm:w-[100px] sm:h-[100px] md:w-[152px] md:h-[152px] lg:w-[170px] lg:h-[170px] rounded-xl object-cover mb-3 md:mb-0 md:mr-4" 
                       src="https://placehold.co/500x500/f97316/FFFFFF/png?text=خبر" alt="صورة خبر {{ news_item.title }}">
                </a>
                {% endif %}
          
                <div class="flex flex-col justify-between pr-2 w-full">
                  <a href="{% url 'details_news' news_item.id %}" class="block">
                    <h1 class="7-words text-right hover:underline text-primary-500 font-bold text-md sm:text-xl lg:text-2xl xl:text-right leading-snug mb-2">
                      {{ news_item.title }}
                    </h1>
                  </a>
                  <div class="mb-4 text-right">
                    <div class="hidden lg:inline text-right text-sm sm:text-md">
                      {{ news_item.content_preview|truncatewords:30 }}
                    </div>
                  </div>
                  <div classs="flex justify-between items-center">
                      <div class="flex items-center">
                        <!-- LINK TO WRITER PROFILE -->
                        <a href="{% url 'writer_profile' news_item.author.id %}" class="text-right text-sm sm:text-md text-primary-500 hover:underline">
                          {{ news_item.author.first_name }} {{ news_item.author.last_name }}
                        </a>
                      </div>
                  </div>
                  <p class="text-sm text-right sm:text-md text-gray-400">
                    تاريخ النشر: {{ news_item.date_start }}
                  </p>
                </div>
              </div>
            </div>
          </div>
          {% empty %}
          <p class="text-gray-500 text-center py-10">لا توجد أخبار من هذا النادي حالياً.</p>
          {% endfor %}
        </div>

        <!-- Blogs Column -->
        <div class="w-full xl:w-1/2 xl:px-1 mt-4 xl:mt-0">
          <div class="xl:hidden text-right mx-auto px-5 pb-2 text-4xl font-bold " dir="rtl">
            <p>مقالات النادي</p>
          </div>
          
          <!-- Loop through related_blogs -->
          {% for blog in related_blogs %}
          <div class="block hover:bg-[#eeede8]">
            <div class="w-full border-[3px] border-primary-400 text-text h-full rounded-md xl:rounded-xl mt-2 mb-4">
              <div class="w-full h-full p-5 border-primary-400 text-text rounded-lg shadow-md lg:flex">
                
                {% if blog.img %}
                <a href="{% url 'details_blog' blog.id %}" class="block flex-shrink-0">
                  <img class="w-full h-[200px] rounded-xl object-cover mb-3 md:h-[50%] lg:w-[290px] lg:h-[289px]" 
                       src="{{ blog.img.url }}" alt="صورة مقال {{ blog.title }}">
                </a>
                {% else %}
                <a href="{% url 'details_blog' blog.id %}" class="block flex-shrink-0">
                  <img class="w-full h-[200px] rounded-xl object-cover mb-3 md:h-[50%] lg:w-[290px] lg:h-[289px]" 
                       src="https://placehold.co/500x500/f97316/FFFFFF/png?text=مقال" alt="صورة مقال {{ blog.title }}">
                </a>
                {% endif %}
          
                <div class="flex flex-col justify-between pr-2 w-full lg:px-5">
                  <a href="{% url 'details_blog' blog.id %}" class="block">
                    <h1 class="font-bold hover:underline text-primary-500 text-xl md:text-3xl lg:text-2xl text-right leading-snug mb-2">
                      {{ blog.title }}
                    </h1>
                  </a>
                  <div class="text-right lg:pb-5">
                    <p class="text-right text-md md:text-lg inline mb-4 lg:text-md">
                      {{ blog.content_preview|truncatewords:20 }}
                    </D>
                  </div>
                   <div classs="flex justify-between items-center">
                      <div class="flex items-center mt-4">
                        <!-- LINK TO WRITER PROFILE -->
                        <a href="{% url 'writer_profile' blog.author.id %}" class="text-right text-md md:text-lg text-primary-500 hover:underline">
                          {{ blog.author.first_name }} {{ blog.author.last_name }}
                        </a>
                      </div>
                  </div>
                  <p classs="text-md text-right md:text-lg text-gray-400">
                    تاريخ النشر: {{ blog.date }}
                  </all-blogs>
                </div>
              </div>
            </div>
          </div>
          {% empty %}
          <p class="text-gray-500 text-center py-10">لا توجد مقالات من هذا النادي حالياً.</p>
          {% endfor %}
        </div>
            
      </div>

    </div>
  </div>

</section>
{% endblock content %}

